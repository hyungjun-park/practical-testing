# Practical Testing: 실용적인 테스트

## 단위 테스트
작은 코드 단위를 독립적으로 검증하는 테스트 (클래스 or 메서드)
- 검증 속도가 빠르고, 안정적이다.

## JUnit 5
단위 테스트를 위한 테스트 프레임워크

## AssertJ
테스트 코드 작성을 원활하게 돕는 테스트 라이브러리

---
## 테스트 케이스 세분화하기
### 해피 케이스
요구 사항에 대한 테스트
### 예외 케이스
요구 사항에서 발생 할 수 있는 예외에 대한 테스트

---
## Test Layer
### Persistence Layer (Repository)
- Data Access의 역할
- 비즈니스 가공 로직이 포함되어서는 안 된다.
- Data에 대한 CRUD에만 집중한 레이어

### Business Layer (Service)
- 비즈니스 로직을 구현하는 역할
- Persistence Layer와의 상호작용(Data를 읽고 쓰는 행위)을 통해 비즈니스 로직을 전개시킨다.
- **트랜잭션**을 보장해야 한다.

### PresentationLayer
- 외부 요청을 가장 먼저 받는 계층
- 파라미터에 대한 최소한의 검증을 수행한다.

#### MockMvc
- Mock(가짜) 객체를 사용해 스프링 MVC 동작을 재현할 수 있는 테스트 프레임워크

---
## Test Double
테스트에서 실제 구성요소를 대체하여 독립적인 테스트 환경을 제공하는 모의 객체

### Test Double 의 5가지
1. Dummy  
   아무 것도 하지 않는 강통 객체
2. Fake  
   단순한 형태로 동일한 기능은 수행하나, 프로덕션에서 쓰기에는 부족한 객체 (ex. FakeRepository)
3. Stub  
   테스트에서 요청한 것에 대해 미리 준비한 결과를 제공하는 객체  
    그 외에는 응답하지 않는다.
4. Spy  
    Stub이면서 호출된 내용을 기록하여 보여줄 수 있는 객체  
    일부는 실제 객체처럼 동작시키고 일부만 Stubbing 할 수 있다.
5. Mock
   행위에 대한 기대를 명세하고, 그에 따라 동작하도록 만들어진 객체

### Stubbing
Mock 객체의 행동을 조작하는 것

#### 모든 Mock 객체의 행동
- Null을 리턴한다
- Primitive 타입은 기본 Primitive 값을 리턴한다.
- 콜렉션은 비어있는 콜렉션
- Void 메소드는 예외를 던지지 않고 아무런 일도 발생하지 않는다

#### Mock 객체를 조작해서 (Stubbing)
- 특정한 매개변수를 받은 경우 특정한 값을 리턴하거나 예외를 던지도록 만들 수 있다.
- void 메소드 특정 매개변수를 받거나 호출 된 경우 예외를 발생 시킬 수 있다.
- 메소드가 동일한 매개변수로 여러번 호출될 때 각기 다르게 행동하도록 조작할 수 있다.